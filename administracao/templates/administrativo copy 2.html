{% extends 'template_new.html' %}
{% load bootstrap5 %}
{% load static%}
{% block title %}Painel Administrativo - Prefeitura de Nova Friburgo{% endblock %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/administrativo.css' %}">
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  /* Ajustes específicos para o painel do CEVEST */
  .dashboard-wrapper {
    font-family: 'Inter', sans-serif;
  }

  .dashboard-sidebar {
    background: linear-gradient(180deg, var(--primary-color) 0%, var(--primary-dark) 100%);
  }

  .brand-logo i {
    color: var(--accent-color);
  }

  .nav-link:hover,
  .nav-item.active .nav-link {
    border-left-color: var(--accent-color);
  }

  .stat-card.education {
    border-left-color: #27ae60;
  }

  .stat-card.education .stat-period-badge {
    background: linear-gradient(135deg, #27ae60, #229954);
  }

  .stat-card.students {
    border-left-color: #3498db;
  }

  .stat-card.students .stat-period-badge {
    background: linear-gradient(135deg, #3498db, #2980b9);
  }

  .stat-card.instructors {
    border-left-color: #f39c12;
  }

  .stat-card.instructors .stat-period-badge {
    background: linear-gradient(135deg, #f39c12, #e67e22);
  }

  .stat-card.events {
    border-left-color: #9b59b6;
  }

  .stat-card.events .stat-period-badge {
    background: linear-gradient(135deg, #9b59b6, #8e44ad);
  }

  /* Customização dos action cards */
  .action-card .action-icon.education {
    background: linear-gradient(135deg, #27ae60, #229954);
  }

  .action-card .action-icon.management {
    background: linear-gradient(135deg, #3498db, #2980b9);
  }

  .action-card .action-icon.configuration {
    background: linear-gradient(135deg, #f39c12, #e67e22);
  }

  .action-card .action-icon.reports {
    background: linear-gradient(135deg, #9b59b6, #8e44ad);
  }

  .action-card .action-icon.system {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
  }

  /* Responsividade mobile aprimorada */
  @media (max-width: 768px) {
    .dashboard-sidebar {
      transform: translateX(-100%);
    }
    
    .dashboard-sidebar.mobile-open {
      transform: translateX(0);
    }
    
    .dashboard-content {
      margin-left: 0;
      width: 100%;
    }
    
    .mobile-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 998;
      display: none;
    }
    
    .mobile-overlay.active {
      display: block;
    }
  }
</style>
{% endblock %}
{% block nav %}
{% include 'nav_cursos.html' %}
{% endblock %}

{% block main %}
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

<!-- Professional Dashboard Layout -->
<div class="dashboard-wrapper">
  <!-- Sidebar Menu -->
  <div class="dashboard-sidebar" id="dashboardSidebar">
    <div class="sidebar-header">
      <div class="brand-logo">
        <i class="fas fa-graduation-cap"></i>
        <span>CEVEST Admin</span>
      </div>
      <button class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
      </button>
    </div>
    
    <nav class="sidebar-nav">
      <div class="nav-section">
        <h6 class="nav-section-title">Principal</h6>
        <ul class="nav-menu">
          <li class="nav-item active">
            <a href="{% url 'administrativo' %}" class="nav-link">
              <i class="fas fa-tachometer-alt"></i>
              <span>Dashboard</span>
            </a>
          </li>
        </ul>
      </div>
      
      <div class="nav-section">
        <h6 class="nav-section-title">Configurações</h6>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="{% url 'adm_locais_listar' %}" class="nav-link">
              <i class="fas fa-map-marker-alt"></i>
              <span>Locais</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'adm_instituicoes_listar' %}" class="nav-link">
              <i class="fas fa-university"></i>
              <span>Instituições</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'adm_categorias_listar' %}" class="nav-link">
              <i class="fas fa-tags"></i>
              <span>Categorias</span>
            </a>
          </li>
        </ul>
      </div>
      
      <div class="nav-section">
        <h6 class="nav-section-title">Gestão Acadêmica</h6>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="{% url 'adm_cursos_listar' %}" class="nav-link">
              <i class="fas fa-book-open"></i>
              <span>Cursos</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'adm_alunos_listar' %}" class="nav-link">
              <i class="fas fa-user-graduate"></i>
              <span>Alunos</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'adm_professores_listar' %}" class="nav-link">
              <i class="fas fa-chalkboard-teacher"></i>
              <span>Instrutores</span>
            </a>
          </li>
        </ul>
      </div>
      
      <div class="nav-section">
        <h6 class="nav-section-title">Atividades</h6>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="{% url 'adm_turmas_listar' %}" class="nav-link">
              <i class="fas fa-users"></i>
              <span>Turmas</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" onclick="alert('Funcionalidade de eventos em desenvolvimento')" class="nav-link">
              <i class="fas fa-calendar-check"></i>
              <span>Eventos</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="fas fa-presentation"></i>
              <span>Palestras</span>
            </a>
          </li>
        </ul>
      </div>
      
      <div class="nav-section">
        <h6 class="nav-section-title">Sistema</h6>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="{% url 'demo_install' %}" class="nav-link">
              <i class="fas fa-download"></i>
              <span>Instalar Demo</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'demo_uninstall' %}" class="nav-link danger">
              <i class="fas fa-trash"></i>
              <span>Remover Demo</span>
            </a>
          </li>
        </ul>
      </div>
    </nav>
    
    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-details">
          <span class="user-name">{{ user.first_name|default:user.username }}</span>
          <span class="user-role">Administrador</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Dashboard Content -->
  <div class="dashboard-content">
    <!-- Top Bar -->
    <div class="dashboard-topbar">
      <div class="topbar-left">
        <h1 class="page-title">
          <i class="fas fa-graduation-cap me-2"></i>
          Painel Administrativo CEVEST
        </h1>
        <p class="page-subtitle">Centro de controle para gestão educacional</p>
      </div>
      <div class="topbar-right">
        <div class="quick-actions">
          <button class="btn-action" title="Atualizar dados" onclick="location.reload()">
            <i class="fas fa-sync-alt"></i>
          </button>
          <button class="btn-action" title="Configurações">
            <i class="fas fa-cog"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Dashboard Stats Grid -->
    <div class="stats-grid">
      <!-- Cursos Ativos -->
      <div class="stat-card education">
        <div class="stat-period-badge recent-badge">
          <i class="fas fa-calendar-day"></i>
          <span>ATIVOS</span>
        </div>
        <div class="stat-content">
          <div class="stat-number">45</div>
          <div class="stat-label">Cursos Ativos</div>
          <div class="stat-sublabel">Disponíveis para matrícula</div>
        </div>
      </div>

      <!-- Alunos Matriculados -->
      <div class="stat-card students">
        <div class="stat-period-badge recent-badge">
          <i class="fas fa-users"></i>
          <span>TOTAL</span>
        </div>
        <div class="stat-content">
          <div class="stat-number">1,247</div>
          <div class="stat-label">Alunos Matriculados</div>
          <div class="stat-sublabel">Em cursos ativos</div>
        </div>
      </div>
      
      <!-- Instrutores -->
      <div class="stat-card instructors">
        <div class="stat-period-badge recent-badge">
          <i class="fas fa-chalkboard-teacher"></i>
          <span>ATIVO</span>
        </div>
        <div class="stat-content">
          <div class="stat-number">38</div>
          <div class="stat-label">Instrutores</div>
          <div class="stat-sublabel">Professores cadastrados</div>
        </div>
      </div>

      <!-- Eventos -->
      <div class="stat-card events">
        <div class="stat-period-badge recent-badge">
          <i class="fas fa-calendar-check"></i>
          <span>MÊS</span>
        </div>
        <div class="stat-content">
          <div class="stat-number">12</div>
          <div class="stat-label">Eventos</div>
          <div class="stat-sublabel">Programados este mês</div>
        </div>
      </div>
    </div>

    <!-- Quick Actions Section -->
    <div class="actions-section">
      <div class="section-title">
        <h2>Gestão do Sistema</h2>
        <p>Principais funcionalidades administrativas</p>
      </div>
      
      <div class="actions-grid">
        <!-- Configurações Principais -->
        <a href="{% url 'adm_locais_listar' %}" class="action-card">
          <div class="action-icon configuration">
            <i class="fas fa-map-marker-alt"></i>
          </div>
          <div class="action-content">
            <h3>Locais de Cursos</h3>
            <p>Gerencie salas e espaços de ensino</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <a href="{% url 'adm_instituicoes_listar' %}" class="action-card">
          <div class="action-icon management">
            <i class="fas fa-university"></i>
          </div>
          <div class="action-content">
            <h3>Instituições</h3>
            <p>Configure organizações parceiras</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <a href="{% url 'adm_categorias_listar' %}" class="action-card">
          <div class="action-icon configuration">
            <i class="fas fa-tags"></i>
          </div>
          <div class="action-content">
            <h3>Categorias</h3>
            <p>Organize tipos de atividades</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <!-- Gestão Acadêmica -->
        <a href="{% url 'adm_cursos_listar' %}" class="action-card">
          <div class="action-icon education">
            <i class="fas fa-book-open"></i>
          </div>
          <div class="action-content">
            <h3>Cursos</h3>
            <p>Cadastre e edite cursos oferecidos</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <a href="{% url 'adm_alunos_listar' %}" class="action-card">
          <div class="action-icon education">
            <i class="fas fa-user-graduate"></i>
          </div>
          <div class="action-content">
            <h3>Alunos</h3>
            <p>Gerencie estudantes e matrículas</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <a href="{% url 'adm_professores_listar' %}" class="action-card">
          <div class="action-icon management">
            <i class="fas fa-chalkboard-teacher"></i>
          </div>
          <div class="action-content">
            <h3>Instrutores</h3>
            <p>Cadastre e gerencie professores</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <!-- Atividades -->
        <a href="{% url 'adm_turmas_listar' %}" class="action-card">
          <div class="action-icon reports">
            <i class="fas fa-users"></i>
          </div>
          <div class="action-content">
            <h3>Turmas</h3>
            <p>Organize grupos de estudantes</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <a href="#" onclick="alert('Funcionalidade de eventos em desenvolvimento')" class="action-card">
          <div class="action-icon reports">
            <i class="fas fa-calendar-check"></i>
          </div>
          <div class="action-content">
            <h3>Eventos</h3>
            <p>Programe atividades especiais</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <a href="#" class="action-card">
          <div class="action-icon reports">
            <i class="fas fa-presentation"></i>
          </div>
          <div class="action-content">
            <h3>Palestras</h3>
            <p>Agende apresentações e workshops</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <!-- Sistema de Demonstração -->
        <a href="{% url 'demo_install' %}" class="action-card" 
           onclick="return confirm('Deseja instalar os dados de demonstração? Isso criará cursos, alunos, professores e turmas de exemplo.')">
          <div class="action-icon success">
            <i class="fas fa-download"></i>
          </div>
          <div class="action-content">
            <h3>Instalar Dados Demo</h3>
            <p>Criar dados de exemplo para testes</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>

        <a href="{% url 'demo_uninstall' %}" class="action-card danger" 
           onclick="return confirm('Deseja remover TODOS os dados de demonstração? Esta ação não pode ser desfeita!')">
          <div class="action-icon system">
            <i class="fas fa-trash-alt"></i>
          </div>
          <div class="action-content">
            <h3>Remover Dados Demo</h3>
            <p>Excluir todos os dados de exemplo</p>
          </div>
          <div class="action-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Mobile Overlay -->
<div class="mobile-overlay" id="mobileOverlay"></div>

<!-- JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Sidebar toggle functionality
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebar = document.getElementById('dashboardSidebar');
    const mobileOverlay = document.getElementById('mobileOverlay');
    
    sidebarToggle.addEventListener('click', function() {
        if (window.innerWidth <= 768) {
            sidebar.classList.toggle('mobile-open');
            mobileOverlay.classList.toggle('active');
        } else {
            sidebar.classList.toggle('collapsed');
        }
    });

    // Close sidebar when clicking overlay
    mobileOverlay.addEventListener('click', function() {
        sidebar.classList.remove('mobile-open');
        mobileOverlay.classList.remove('active');
    });

    // Handle window resize
    window.addEventListener('resize', function() {
        if (window.innerWidth > 768) {
            sidebar.classList.remove('mobile-open');
            mobileOverlay.classList.remove('active');
        }
    });

    // Animate stat numbers on page load
    function animateValue(element, start, end, duration) {
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            element.innerHTML = Math.floor(progress * (end - start) + start).toLocaleString();
            if (progress < 1) {
                window.requestAnimationFrame(step);
            }
        };
        window.requestAnimationFrame(step);
    }

    // Animate stat numbers
    setTimeout(() => {
        document.querySelectorAll('.stat-number').forEach(stat => {
            const finalValue = parseInt(stat.textContent.replace(/,/g, ''));
            stat.textContent = '0';
            animateValue(stat, 0, finalValue, 1500);
        });
    }, 500);

    // Add smooth transitions to action cards
    const actionCards = document.querySelectorAll('.action-card');
    actionCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        
        setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, 100 + (index * 50));
    });
});
</script>
{% endblock %}